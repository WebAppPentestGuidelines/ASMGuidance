---
title: "第4章 ASMツール/サービスの選定"
weight: 4
# bookFlatSection: false
# bookToc: true
# bookHidden: false
# bookCollapseSection: false
# bookComments: false
# bookSearchExclude: false
---
# 第4章 ASMツール/サービスの選定

## 本ドキュメントでのケース設定

課題を整理した結果、やはりASM導入が必要となるケースもあります。前節で挙げた課題の一部を例にとり、考察してみます。
- 企業構造や組織構造により、IT資産を一元管理することが難しい
- 脆弱性管理は現場に委ねており、第三者的観点を取り入れられていない
- 攻撃に悪用されている脆弱性が公表されても、横断的な調査に時間がかかる

上記の課題解決を既存の枠組みのまま行うには、膨大なコミュニケーション・人的・金銭的コストがかかることが予想できるため、ASMが解決手段の一つの選択肢となり得ます。  
本ケースで必要となるASMの機能は、インターネット上のIT資産の探索と脆弱性の調査であるため、EASMが要件に合致するツールとして候補にあがります。本章で掘り下げて解説します。    

**本章ではEASM（インターネット上のIT資産の探索と脆弱性の調査）のことをASMとして説明していきます。**

## 4.1 ASMツールに求める機能
本節では「本ドキュメントでのケース設定」に対応する形でASMツールに求められる機能を説明します。なお、ASMツールは提供する企業（セキュリティベンダ）によって機能や内容が多岐に渡るため、本節では多くのASMツールに共通するコア機能である「IT資産の発見」機能、「脆弱性情報含むIT資産の付加情報収集」機能、そして「IT資産のリスク評価」機能を説明し、最後にASMツールによって実装有無が異なるその他機能を説明します。

### IT資産の発見
インターネットに公開されているIT資産を自動的に収集します。    
本機能では、組織名を起点としたドメイン特定や、ドメインを起点としたFQDN特定を行います。また、特定したFQDNから紐づくIPアドレスも併せて特定します。本機能により、従来の管理方法では管理から漏れていたIT資産を把握することができ、管理が行き届いていないシャドーITを特定することができます。    

ASMツールが発見できるIT資産の一例を以下に示します。  

| 資産の種別 | 説明 |
| ---------------- | -- |
| ドメイン | 組織が保有するドメイン名。ASMツールでは、ドメイン取得代行サービス経由で取得したドメインや、自組織で取得したドメインを特定します。    |
| FQDN   | 組織が運用しているWebサーバーやメールサーバー等に割り当てられたホスト名。ASMツールでは、正規サービスに利用されているFQDNの他、キャンペーン等で一時利用され、その後の管理が不十分なFQDNや、本来インターネットに公開すべきではないテスト・ステージング用のFQDN等を特定します。    |
| IPアドレス | 組織が保有するFQDNに紐づくIPアドレス。ASMツールでは、FQDNを特定した後、これに紐づくIPアドレスも特定します。 |

なお、ASMツールによっては、IT資産発見の起点が異なる場合があります。あらかじめ利用者にドメイン名を登録させ、これを起点にFQDNを収集するASMツールもあれば、利用者が登録した組織名を起点にドメイン名を特定し、これを基にFQDNを特定するツールもあります。  

このように、事前に登録する情報によってASM運用が変わるため、ASMツールの導入を検討する際は、自組織の運用やリソースと照らし合わせて最適なASMツールを選定する必要があります。  

### 脆弱性情報含むIT資産の付加情報収集
IT資産のリスク評価を行うために必要な情報を収集します。    
本機能により、IT資産が安全な状態なのか、または攻撃を受ける可能性が高い状態なのか、管理が行き届いていないのか等、IT資産のリスク評価を行うための情報を得ることができます。  

以下、ASMツールが収集できるIT資産の付加情報例を示します。  

| IT資産の付加情報     | 説明 |
| ------------ | ---- |
| オープンポート |IT資産で有効になっているサービス（ポート）|
| ソフトウェア名・バージョン情報 | IT資産で稼働しているソフトウェア名やバージョン情報<br>バナー情報や（IT資産がWebサーバーであれば）URL内のファイル拡張子を基に特定|
| サーバー証明書 |IT資産で使用されているサーバー証明書|
| 暗号設定 |IT資産の暗号設定（暗号プロトコル、暗号スイート）|

次に、ASMツールは上記の付加情報を分析し、IT資産のリスク評価を行うための情報を特定します。

| リスク評価のための情報     | 説明 |
| ------------ | ---- |
| 脆弱性情報 |特定したソフトウェア名・バージョン情報から、当該ソフトウェアに関連する脆弱性情報（CVE）をNIST NVD（National Vulunerability Database）やCISA Vulnrichment等の脆弱性データベースから収集|
| 設定不備情報 |特定したIT資産の付加情報から、攻撃に悪用され得るポートの有無やサーバー証明書の不備（有効期限切れや自己署名証明書等）、暗号設定の不備（HTTPSの未使用や脆弱な暗号アルゴリズムの使用等）、サーバー設定の不備（ディレクトリインデックスの有効化、機微情報が公開状態になっている等）を特定|

### IT資産のリスク評価
IT資産のリスク評価を行います。    
上記で特定したリスク評価のための情報を基に、IT資産のリスク評価を行います。評価結果の提示方法はASMツールによって異なりますが、例えば「High、Medium、Low」のようにリスク度合いに応じた段階的評価で提示する場合が一般的です。これにより、ASMツールの利用者は一目で自組織のIT資産が攻撃を受け得る危険な状態なのか、または安全な状態なのかを把握することができます。    

なお、リスク評価はASMツール独自の基準で行うことがあります。脆弱性情報のみで評価を行うツールもあれば、設定不備情報も加味して評価を行うツールもあります。このため、ASMツールを導入する際は、自組織が求めるリスク評価基準と照らし合わせて最適なASMツールを選定する必要があります。

### その他の機能（運用をサポートする機能等）
これまでは、多くのASMツールに共通するコア機能を説明しました。ここからは、ASMツール毎に異なる特色のある機能を説明していきます。

前章でも述べたように、ASM運用はツールを入れて終わりではありません。ASMツールを適切に運用し、発見されたIT資産や脆弱性に対処することが求められます。しかし、ASMツールを使用すると大量のIT資産や大量の脆弱性が発見されることがあり、これらを適切に処理していくためには多大なコストがかかります。そこで、多くのASMツールでは、ASM運用を円滑に行うためのサポート機能が実装されています。

以下にサポート機能の一例を示します。

| 機能 | 説明 |
| ------------ | ---- |
| ダッシュボード機能 | 発見したIT資産や付加情報、脆弱性情報等をグラフやマップ等で視覚的に表示します。ASM全体の傾向や特定リスクの分布を一目で把握するのに役立ちます。|
| 担当者の管理機能 | 発見したIT資産に担当者を紐付けて管理することで、IT資産の担当者（管理者）を明確にします。これにより、脆弱性が発見された際の対応指示先が明確化され、迅速な脆弱性対応が可能となります。|
| タスク管理機能 | 脆弱性や設定不備の対応は指示を出して終わりではなく、対応状況を追跡し、正しく対処されたか確認する必要があります。対応状況をタスクとして管理することで、誰がどの脆弱性に対応しているか、現在の対応状況、そして対応完了の判断を誰が下したのかを把握することが可能となります。|
| IT資産の登録機能 | ASMツールは機械的にIT資産の発見を行うため、どうしても発見できないIT資産も存在し得ます。そこで、利用者が保持しているIT資産リストのインポートや手動登録する機能を提供することで、ASMツール上で管理できるIT資産のカバレッジを向上させることができます。  |
| コミュニケーション機能 | 発見されたIT資産や脆弱性、また脆弱性対応に関する情報を関係者と効率的に共有します。これにより、脆弱性の対応担当者や管理者間で迅速な情報伝達が可能となり、ASM運用を効率よく行うことが可能となります。  |
| レポート機能 | リスク評価レポートや発見したIT資産の一覧を生成・出力します。これにより、ASMのステークホルダー（社内メンバー、上司、顧客など）への報告やセキュリティ対策の計画が円滑に進みます。  |
| 通知機能 | 新たなIT資産や脆弱性が発見された際、IT資産の担当者や管理者に通知を送信します。これにより、重要な情報を迅速に共有することが可能です。通知は、Eメールやチャットシステムを通じて行われる場合があります。  |
| 外部連携機能 | ASMの結果を他のセキュリティツールや情報システム等と連携します。これにより、ASMツールが収集した結果を基に他ツールで分析やモニタリングを行うことで、より深い洞察を得ることができます。また、本機能があることで、ASMツール導入前から使用していたツールとの連携がスムーズになり、ASMツールを導入しやすくなるメリットもあります。  |
| 監査機能 | ASMツールの利用者による操作ログを収集・保存します。ASMツールには自組織のIT資産や脆弱性情報といった重要なデータが保管されているため、操作ログを記録することで操作履歴の追跡や監査が可能となります。  |

このように、ASMツールにはASM運用を円滑に行うためのサポート機能が備わっています。これらの機能を有効利用することで、ASM運用の課題解決や負荷を低減させることができます。  


## 4.2 ASMツールの注意点
ASMツールは、組織のIT資産（特にアタックサーフェス）の洗い出しや管理をする上で有用ですが、ツールの機能や導入・運用に際しては注意が必要な点もあります。

### ASMツールの機能に関する注意点

**IT資産の誤検出**
ASMツールでは、組織が把握しきれていないものも含めてインターネットに公開されているIT資産を自動的に収集できますが、その検出結果には誤検出が含まれる可能性があります。  
誤検出の具体例としては、現在は存在していないIT資産や、自組織とは関係のない全く別の組織のIT資産などが該当します。  
ASMツールは発見されたIT資産に対してリスクの検出・評価も行うため、誤検出されたIT資産がスキャンの対象とならないように注意する必要があります。  
そのためには、ASMツールでのIT資産の検出結果を鵜吞みにせず、自組織のものかどうかを確認する必要があります。（自組織に関連するIT資産であっても、管理をアウトソースしている場合などスキャン対象としてよいか確認が必要なものもあります。）

**IT資産の検出方法**
ASMツールには、前節「IT資産の発見」で紹介したIT資産発見の起点により、検出精度（検出結果）に違いがあります。  
例えば、ドメイン名を登録して起点とする場合、探索元が既に自組織の資産（自組織のドメイン）であることが分かっているため、同じドメイン上のIT資産はほぼ自組織のものであると言えます。他方、組織名やブランド名を登録して起点とする場合、探索過程で類似の組織やブランドの資産が混在することが想定されます。検出結果に対応するための労力を考えれば、前者の方が誤検出が少なく採用しやすいと考えられますが、発見される「未知のIT資産」の量は後者の方が多く、リスクの低減に寄与しやすいと考えられます。そのため、ASMツールの選定時にはどのような探索プロセスが好ましいのかについても検討することをお勧めします。

**リスク評価（スキャン）の実施タイミング**
前項で、ASMツールにおけるIT資産の誤検出に関する注意点を説明し、ASMツールで検出されたIT資産の結果を確認することが重要と述べました。この確認はリスクの検出・評価のスキャンを行う前に実施すべきですが、ASMツールによってはIT資産の検出後に自動的にスキャンまで実施してしまうものも存在するため注意が必要です。  
特に海外製のASMツールでは、セキュリティに対する考え方や法律などの違いから、アグレッシブな動作をするツールが少なくありません。導入前に、利用するASMツールのスキャンの実施タイミングやスキャン内容などの、挙動・影響範囲に関する仕様をよく確認しておきましょう。  

**リスク評価（スキャン内容）と正確性**

2.4節「ASMと脆弱性診断の違い」でも述べたように、ASMツールによるリスク評価のみでは、全ての脆弱性を特定できません。そのため、ASMツールによる脆弱性検出やリスク評価の限界を理解し、脆弱性診断や他のセキュリティ対策と併用することも検討しましょう。  

また、一部のASMツールでは、脆弱性検出・評価の正確性を上げるために、脆弱性診断と同様の疑似攻撃を含むスキャンを実行するツールもあります。このようなスキャン機能は、対象のIT資産に負荷をかけたり、疑似攻撃による副作用が発生したりする可能性があるため、スキャン内容とその影響についても把握・理解したうえで活用することが重要です。また、対象に影響を与えるようなスキャンを実施する場合は、脆弱性診断と近しいと考えて、先述の「誤検出」などの注意点も考慮し、自組織のIT資産であることの確認や事前調整を行った上での利用をお勧めします。

### 導入・運用に際しての注意点

**料金体系の違い**

ASMツールによって料金体系が異なるため検討時の確認が重要です。  
ツールによっては、自組織やグループ企業だけでなく外部の企業も含めて管理できるものもあります。以下に代表的な料金体系を紹介します。

| 課金対象 | 説明 |
| ------- | ---- |
| 組織規模(従業員数や売上) | ASMツールを利用する組織の規模(従業員数や売上)に基づく料金体系です。広範囲の外部攻撃面を管理したい場合には他の料金体系よりもスケールメリットがあります。|
| 企業数 | 管理対象とする企業数に基づく料金体系です。自組織やグループ企業だけでなく外部の企業も含めた管理が可能な場合もあります。 |
| ドメイン数 | 組織が管理するドメイン数に基づく料金体系です。課金対象となるドメインは、FQDNに基づく場合もあれば、サブドメインを含めないドメイン(厳密には、Zone Apex(APEXドメイン)もしくはeTLD+1)に基づく場合もあります。 |
| 機能制限 | スキャンの回数やAPIの利用回数などの機能制限数に基づいた料金体系です。機能利用の上限に達した場合、上位プランへのアップグレードが求められることや、利用したい回数分だけ料金を支払うクレジット方式が採用されているケースがあります。 |

**運用計画の検討とトライアル**

本ドキュメントで解説してきたようにASMはプロセスであり、ASMツールを導入して終わりではありません。ASMツールではその特性上、未把握のIT資産やリスク情報が大量に検出される可能性があり、運用負荷は高くなりがちです。導入前にASMで解決したい課題とその運用を検討し、十分なリソースを確保することが重要です。  
また、ASMツールによって検出された情報と、既存の情報やシステムとの連携についても事前に想定しておく必要があります。導入するASMツールの管理機能を利用するだけでなく、既存の情報をASMツール側に統合したり、逆に既存のセキュリティソリューションにASMツールの情報を連携させたりといった活用が考えられます。  

なお、ほとんどのASMツールは購入前にトライアル(試用)することが可能です。導入前に、ドキュメントや仕様書による机上検証だけでなく実際に試してみることで、具体的な運用上の負担や影響を事前に確認することができます。本節で説明した注意点も踏まえながら、実際に試すことを推奨します。

